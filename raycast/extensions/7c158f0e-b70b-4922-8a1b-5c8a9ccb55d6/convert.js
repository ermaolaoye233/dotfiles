"use strict";var xn=Object.create;var _=Object.defineProperty;var wn=Object.getOwnPropertyDescriptor;var In=Object.getOwnPropertyNames;var bn=Object.getPrototypeOf,vn=Object.prototype.hasOwnProperty;var l=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),En=(e,t)=>{for(var n in t)_(e,n,{get:t[n],enumerable:!0})},De=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of In(t))!vn.call(e,o)&&o!==n&&_(e,o,{get:()=>t[o],enumerable:!(r=wn(t,o))||r.enumerable});return e};var $e=(e,t,n)=>(n=e!=null?xn(bn(e)):{},De(t||!e||!e.__esModule?_(n,"default",{value:e,enumerable:!0}):n,e)),Tn=e=>De(_({},"__esModule",{value:!0}),e);var Oe=l((To,Ne)=>{Ne.exports=Re;Re.sync=Fn;var Ge=require("fs");function Cn(e,t){var n=t.pathExt!==void 0?t.pathExt:process.env.PATHEXT;if(!n||(n=n.split(";"),n.indexOf("")!==-1))return!0;for(var r=0;r<n.length;r++){var o=n[r].toLowerCase();if(o&&e.substr(-o.length).toLowerCase()===o)return!0}return!1}function Ae(e,t,n){return!e.isSymbolicLink()&&!e.isFile()?!1:Cn(t,n)}function Re(e,t,n){Ge.stat(e,function(r,o){n(r,r?!1:Ae(o,e,t))})}function Fn(e,t){return Ae(Ge.statSync(e),e,t)}});var Me=l((Co,Le)=>{Le.exports=ke;ke.sync=Dn;var Be=require("fs");function ke(e,t,n){Be.stat(e,function(r,o){n(r,r?!1:qe(o,t))})}function Dn(e,t){return qe(Be.statSync(e),t)}function qe(e,t){return e.isFile()&&$n(e,t)}function $n(e,t){var n=e.mode,r=e.uid,o=e.gid,s=t.uid!==void 0?t.uid:process.getuid&&process.getuid(),i=t.gid!==void 0?t.gid:process.getgid&&process.getgid(),a=parseInt("100",8),c=parseInt("010",8),u=parseInt("001",8),f=a|c,g=n&u||n&c&&o===i||n&a&&r===s||n&f&&s===0;return g}});var je=l((Do,_e)=>{var Fo=require("fs"),j;process.platform==="win32"||global.TESTING_WINDOWS?j=Oe():j=Me();_e.exports=ne;ne.sync=Gn;function ne(e,t,n){if(typeof t=="function"&&(n=t,t={}),!n){if(typeof Promise!="function")throw new TypeError("callback not provided");return new Promise(function(r,o){ne(e,t||{},function(s,i){s?o(s):r(i)})})}j(e,t||{},function(r,o){r&&(r.code==="EACCES"||t&&t.ignoreErrors)&&(r=null,o=!1),n(r,o)})}function Gn(e,t){try{return j.sync(e,t||{})}catch(n){if(t&&t.ignoreErrors||n.code==="EACCES")return!1;throw n}}});var ze=l(($o,Ke)=>{var E=process.platform==="win32"||process.env.OSTYPE==="cygwin"||process.env.OSTYPE==="msys",Ue=require("path"),An=E?";":":",We=je(),Xe=e=>Object.assign(new Error(`not found: ${e}`),{code:"ENOENT"}),He=(e,t)=>{let n=t.colon||An,r=e.match(/\//)||E&&e.match(/\\/)?[""]:[...E?[process.cwd()]:[],...(t.path||process.env.PATH||"").split(n)],o=E?t.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM":"",s=E?o.split(n):[""];return E&&e.indexOf(".")!==-1&&s[0]!==""&&s.unshift(""),{pathEnv:r,pathExt:s,pathExtExe:o}},Ve=(e,t,n)=>{typeof t=="function"&&(n=t,t={}),t||(t={});let{pathEnv:r,pathExt:o,pathExtExe:s}=He(e,t),i=[],a=u=>new Promise((f,g)=>{if(u===r.length)return t.all&&i.length?f(i):g(Xe(e));let h=r[u],S=/^".*"$/.test(h)?h.slice(1,-1):h,y=Ue.join(S,e),x=!S&&/^\.[\\\/]/.test(e)?e.slice(0,2)+y:y;f(c(x,u,0))}),c=(u,f,g)=>new Promise((h,S)=>{if(g===o.length)return h(a(f+1));let y=o[g];We(u+y,{pathExt:s},(x,v)=>{if(!x&&v)if(t.all)i.push(u+y);else return h(u+y);return h(c(u,f,g+1))})});return n?a(0).then(u=>n(null,u),n):a(0)},Rn=(e,t)=>{t=t||{};let{pathEnv:n,pathExt:r,pathExtExe:o}=He(e,t),s=[];for(let i=0;i<n.length;i++){let a=n[i],c=/^".*"$/.test(a)?a.slice(1,-1):a,u=Ue.join(c,e),f=!c&&/^\.[\\\/]/.test(e)?e.slice(0,2)+u:u;for(let g=0;g<r.length;g++){let h=f+r[g];try{if(We.sync(h,{pathExt:o}))if(t.all)s.push(h);else return h}catch{}}}if(t.all&&s.length)return s;if(t.nothrow)return null;throw Xe(e)};Ke.exports=Ve;Ve.sync=Rn});var oe=l((Go,re)=>{"use strict";var Je=(e={})=>{let t=e.env||process.env;return(e.platform||process.platform)!=="win32"?"PATH":Object.keys(t).reverse().find(r=>r.toUpperCase()==="PATH")||"Path"};re.exports=Je;re.exports.default=Je});var et=l((Ao,Qe)=>{"use strict";var Ze=require("path"),Nn=ze(),On=oe();function Ye(e,t){let n=e.options.env||process.env,r=process.cwd(),o=e.options.cwd!=null,s=o&&process.chdir!==void 0&&!process.chdir.disabled;if(s)try{process.chdir(e.options.cwd)}catch{}let i;try{i=Nn.sync(e.command,{path:n[On({env:n})],pathExt:t?Ze.delimiter:void 0})}catch{}finally{s&&process.chdir(r)}return i&&(i=Ze.resolve(o?e.options.cwd:"",i)),i}function Bn(e){return Ye(e)||Ye(e,!0)}Qe.exports=Bn});var tt=l((Ro,ie)=>{"use strict";var se=/([()\][%!^"`<>&|;, *?])/g;function kn(e){return e=e.replace(se,"^$1"),e}function qn(e,t){return e=`${e}`,e=e.replace(/(\\*)"/g,'$1$1\\"'),e=e.replace(/(\\*)$/,"$1$1"),e=`"${e}"`,e=e.replace(se,"^$1"),t&&(e=e.replace(se,"^$1")),e}ie.exports.command=kn;ie.exports.argument=qn});var rt=l((No,nt)=>{"use strict";nt.exports=/^#!(.*)/});var st=l((Oo,ot)=>{"use strict";var Ln=rt();ot.exports=(e="")=>{let t=e.match(Ln);if(!t)return null;let[n,r]=t[0].replace(/#! ?/,"").split(" "),o=n.split("/").pop();return o==="env"?r:r?`${o} ${r}`:o}});var at=l((Bo,it)=>{"use strict";var ae=require("fs"),Mn=st();function _n(e){let n=Buffer.alloc(150),r;try{r=ae.openSync(e,"r"),ae.readSync(r,n,0,150,0),ae.closeSync(r)}catch{}return Mn(n.toString())}it.exports=_n});var dt=l((ko,lt)=>{"use strict";var jn=require("path"),ct=et(),ut=tt(),Un=at(),Wn=process.platform==="win32",Xn=/\.(?:com|exe)$/i,Hn=/node_modules[\\/].bin[\\/][^\\/]+\.cmd$/i;function Vn(e){e.file=ct(e);let t=e.file&&Un(e.file);return t?(e.args.unshift(e.file),e.command=t,ct(e)):e.file}function Kn(e){if(!Wn)return e;let t=Vn(e),n=!Xn.test(t);if(e.options.forceShell||n){let r=Hn.test(t);e.command=jn.normalize(e.command),e.command=ut.command(e.command),e.args=e.args.map(s=>ut.argument(s,r));let o=[e.command].concat(e.args).join(" ");e.args=["/d","/s","/c",`"${o}"`],e.command=process.env.comspec||"cmd.exe",e.options.windowsVerbatimArguments=!0}return e}function zn(e,t,n){t&&!Array.isArray(t)&&(n=t,t=null),t=t?t.slice(0):[],n=Object.assign({},n);let r={command:e,args:t,options:n,file:void 0,original:{command:e,args:t}};return n.shell?r:Kn(r)}lt.exports=zn});var mt=l((qo,ft)=>{"use strict";var ce=process.platform==="win32";function ue(e,t){return Object.assign(new Error(`${t} ${e.command} ENOENT`),{code:"ENOENT",errno:"ENOENT",syscall:`${t} ${e.command}`,path:e.command,spawnargs:e.args})}function Jn(e,t){if(!ce)return;let n=e.emit;e.emit=function(r,o){if(r==="exit"){let s=pt(o,t,"spawn");if(s)return n.call(e,"error",s)}return n.apply(e,arguments)}}function pt(e,t){return ce&&e===1&&!t.file?ue(t.original,"spawn"):null}function Zn(e,t){return ce&&e===1&&!t.file?ue(t.original,"spawnSync"):null}ft.exports={hookChildProcess:Jn,verifyENOENT:pt,verifyENOENTSync:Zn,notFoundError:ue}});var St=l((Lo,T)=>{"use strict";var ht=require("child_process"),le=dt(),de=mt();function gt(e,t,n){let r=le(e,t,n),o=ht.spawn(r.command,r.args,r.options);return de.hookChildProcess(o,r),o}function Yn(e,t,n){let r=le(e,t,n),o=ht.spawnSync(r.command,r.args,r.options);return o.error=o.error||de.verifyENOENTSync(o.status,r),o}T.exports=gt;T.exports.spawn=gt;T.exports.sync=Yn;T.exports._parse=le;T.exports._enoent=de});var Pt=l((Mo,yt)=>{"use strict";yt.exports=e=>{let t=typeof e=="string"?`
`:`
`.charCodeAt(),n=typeof e=="string"?"\r":"\r".charCodeAt();return e[e.length-1]===t&&(e=e.slice(0,e.length-1)),e[e.length-1]===n&&(e=e.slice(0,e.length-1)),e}});var It=l((_o,N)=>{"use strict";var R=require("path"),xt=oe(),wt=e=>{e={cwd:process.cwd(),path:process.env[xt()],execPath:process.execPath,...e};let t,n=R.resolve(e.cwd),r=[];for(;t!==n;)r.push(R.join(n,"node_modules/.bin")),t=n,n=R.resolve(n,"..");let o=R.resolve(e.cwd,e.execPath,"..");return r.push(o),r.concat(e.path).join(R.delimiter)};N.exports=wt;N.exports.default=wt;N.exports.env=e=>{e={env:process.env,...e};let t={...e.env},n=xt({env:t});return e.path=t[n],t[n]=N.exports(e),t}});var vt=l((jo,pe)=>{"use strict";var bt=(e,t)=>{for(let n of Reflect.ownKeys(t))Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n));return e};pe.exports=bt;pe.exports.default=bt});var Tt=l((Uo,W)=>{"use strict";var Qn=vt(),U=new WeakMap,Et=(e,t={})=>{if(typeof e!="function")throw new TypeError("Expected a function");let n,r=0,o=e.displayName||e.name||"<anonymous>",s=function(...i){if(U.set(s,++r),r===1)n=e.apply(this,i),e=null;else if(t.throw===!0)throw new Error(`Function \`${o}\` can only be called once`);return n};return Qn(s,e),U.set(s,r),s};W.exports=Et;W.exports.default=Et;W.exports.callCount=e=>{if(!U.has(e))throw new Error(`The given function \`${e.name}\` is not wrapped by the \`onetime\` package`);return U.get(e)}});var Ct=l(X=>{"use strict";Object.defineProperty(X,"__esModule",{value:!0});X.SIGNALS=void 0;var er=[{name:"SIGHUP",number:1,action:"terminate",description:"Terminal closed",standard:"posix"},{name:"SIGINT",number:2,action:"terminate",description:"User interruption with CTRL-C",standard:"ansi"},{name:"SIGQUIT",number:3,action:"core",description:"User interruption with CTRL-\\",standard:"posix"},{name:"SIGILL",number:4,action:"core",description:"Invalid machine instruction",standard:"ansi"},{name:"SIGTRAP",number:5,action:"core",description:"Debugger breakpoint",standard:"posix"},{name:"SIGABRT",number:6,action:"core",description:"Aborted",standard:"ansi"},{name:"SIGIOT",number:6,action:"core",description:"Aborted",standard:"bsd"},{name:"SIGBUS",number:7,action:"core",description:"Bus error due to misaligned, non-existing address or paging error",standard:"bsd"},{name:"SIGEMT",number:7,action:"terminate",description:"Command should be emulated but is not implemented",standard:"other"},{name:"SIGFPE",number:8,action:"core",description:"Floating point arithmetic error",standard:"ansi"},{name:"SIGKILL",number:9,action:"terminate",description:"Forced termination",standard:"posix",forced:!0},{name:"SIGUSR1",number:10,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGSEGV",number:11,action:"core",description:"Segmentation fault",standard:"ansi"},{name:"SIGUSR2",number:12,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGPIPE",number:13,action:"terminate",description:"Broken pipe or socket",standard:"posix"},{name:"SIGALRM",number:14,action:"terminate",description:"Timeout or timer",standard:"posix"},{name:"SIGTERM",number:15,action:"terminate",description:"Termination",standard:"ansi"},{name:"SIGSTKFLT",number:16,action:"terminate",description:"Stack is empty or overflowed",standard:"other"},{name:"SIGCHLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"posix"},{name:"SIGCLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"other"},{name:"SIGCONT",number:18,action:"unpause",description:"Unpaused",standard:"posix",forced:!0},{name:"SIGSTOP",number:19,action:"pause",description:"Paused",standard:"posix",forced:!0},{name:"SIGTSTP",number:20,action:"pause",description:'Paused using CTRL-Z or "suspend"',standard:"posix"},{name:"SIGTTIN",number:21,action:"pause",description:"Background process cannot read terminal input",standard:"posix"},{name:"SIGBREAK",number:21,action:"terminate",description:"User interruption with CTRL-BREAK",standard:"other"},{name:"SIGTTOU",number:22,action:"pause",description:"Background process cannot write to terminal output",standard:"posix"},{name:"SIGURG",number:23,action:"ignore",description:"Socket received out-of-band data",standard:"bsd"},{name:"SIGXCPU",number:24,action:"core",description:"Process timed out",standard:"bsd"},{name:"SIGXFSZ",number:25,action:"core",description:"File too big",standard:"bsd"},{name:"SIGVTALRM",number:26,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGPROF",number:27,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGWINCH",number:28,action:"ignore",description:"Terminal window size changed",standard:"bsd"},{name:"SIGIO",number:29,action:"terminate",description:"I/O is available",standard:"other"},{name:"SIGPOLL",number:29,action:"terminate",description:"Watched event",standard:"other"},{name:"SIGINFO",number:29,action:"ignore",description:"Request for process information",standard:"other"},{name:"SIGPWR",number:30,action:"terminate",description:"Device running out of power",standard:"systemv"},{name:"SIGSYS",number:31,action:"core",description:"Invalid system call",standard:"other"},{name:"SIGUNUSED",number:31,action:"terminate",description:"Invalid system call",standard:"other"}];X.SIGNALS=er});var fe=l(C=>{"use strict";Object.defineProperty(C,"__esModule",{value:!0});C.SIGRTMAX=C.getRealtimeSignals=void 0;var tr=function(){let e=Dt-Ft+1;return Array.from({length:e},nr)};C.getRealtimeSignals=tr;var nr=function(e,t){return{name:`SIGRT${t+1}`,number:Ft+t,action:"terminate",description:"Application-specific signal (realtime)",standard:"posix"}},Ft=34,Dt=64;C.SIGRTMAX=Dt});var $t=l(H=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0});H.getSignals=void 0;var rr=require("os"),or=Ct(),sr=fe(),ir=function(){let e=(0,sr.getRealtimeSignals)();return[...or.SIGNALS,...e].map(ar)};H.getSignals=ir;var ar=function({name:e,number:t,description:n,action:r,forced:o=!1,standard:s}){let{signals:{[e]:i}}=rr.constants,a=i!==void 0;return{name:e,number:a?i:t,description:n,supported:a,action:r,forced:o,standard:s}}});var At=l(F=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0});F.signalsByNumber=F.signalsByName=void 0;var cr=require("os"),Gt=$t(),ur=fe(),lr=function(){return(0,Gt.getSignals)().reduce(dr,{})},dr=function(e,{name:t,number:n,description:r,supported:o,action:s,forced:i,standard:a}){return{...e,[t]:{name:t,number:n,description:r,supported:o,action:s,forced:i,standard:a}}},pr=lr();F.signalsByName=pr;var fr=function(){let e=(0,Gt.getSignals)(),t=ur.SIGRTMAX+1,n=Array.from({length:t},(r,o)=>mr(o,e));return Object.assign({},...n)},mr=function(e,t){let n=hr(e,t);if(n===void 0)return{};let{name:r,description:o,supported:s,action:i,forced:a,standard:c}=n;return{[e]:{name:r,number:e,description:o,supported:s,action:i,forced:a,standard:c}}},hr=function(e,t){let n=t.find(({name:r})=>cr.constants.signals[r]===e);return n!==void 0?n:t.find(r=>r.number===e)},gr=fr();F.signalsByNumber=gr});var Nt=l((Ko,Rt)=>{"use strict";var{signalsByName:Sr}=At(),yr=({timedOut:e,timeout:t,errorCode:n,signal:r,signalDescription:o,exitCode:s,isCanceled:i})=>e?`timed out after ${t} milliseconds`:i?"was canceled":n!==void 0?`failed with ${n}`:r!==void 0?`was killed with ${r} (${o})`:s!==void 0?`failed with exit code ${s}`:"failed",Pr=({stdout:e,stderr:t,all:n,error:r,signal:o,exitCode:s,command:i,escapedCommand:a,timedOut:c,isCanceled:u,killed:f,parsed:{options:{timeout:g}}})=>{s=s===null?void 0:s,o=o===null?void 0:o;let h=o===void 0?void 0:Sr[o].description,S=r&&r.code,x=`Command ${yr({timedOut:c,timeout:g,errorCode:S,signal:o,signalDescription:h,exitCode:s,isCanceled:u})}: ${i}`,v=Object.prototype.toString.call(r)==="[object Error]",L=v?`${x}
${r.message}`:x,M=[L,t,e].filter(Boolean).join(`
`);return v?(r.originalMessage=r.message,r.message=M):r=new Error(M),r.shortMessage=L,r.command=i,r.escapedCommand=a,r.exitCode=s,r.signal=o,r.signalDescription=h,r.stdout=e,r.stderr=t,n!==void 0&&(r.all=n),"bufferedData"in r&&delete r.bufferedData,r.failed=!0,r.timedOut=Boolean(c),r.isCanceled=u,r.killed=f&&!c,r};Rt.exports=Pr});var Bt=l((zo,me)=>{"use strict";var V=["stdin","stdout","stderr"],xr=e=>V.some(t=>e[t]!==void 0),Ot=e=>{if(!e)return;let{stdio:t}=e;if(t===void 0)return V.map(r=>e[r]);if(xr(e))throw new Error(`It's not possible to provide \`stdio\` in combination with one of ${V.map(r=>`\`${r}\``).join(", ")}`);if(typeof t=="string")return t;if(!Array.isArray(t))throw new TypeError(`Expected \`stdio\` to be of type \`string\` or \`Array\`, got \`${typeof t}\``);let n=Math.max(t.length,V.length);return Array.from({length:n},(r,o)=>t[o])};me.exports=Ot;me.exports.node=e=>{let t=Ot(e);return t==="ipc"?"ipc":t===void 0||typeof t=="string"?[t,t,t,"ipc"]:t.includes("ipc")?t:[...t,"ipc"]}});var kt=l((Jo,K)=>{K.exports=["SIGABRT","SIGALRM","SIGHUP","SIGINT","SIGTERM"];process.platform!=="win32"&&K.exports.push("SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT");process.platform==="linux"&&K.exports.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT","SIGUNUSED")});var jt=l((Zo,G)=>{var p=global.process,I=function(e){return e&&typeof e=="object"&&typeof e.removeListener=="function"&&typeof e.emit=="function"&&typeof e.reallyExit=="function"&&typeof e.listeners=="function"&&typeof e.kill=="function"&&typeof e.pid=="number"&&typeof e.on=="function"};I(p)?(qt=require("assert"),D=kt(),Lt=/^win/i.test(p.platform),O=require("events"),typeof O!="function"&&(O=O.EventEmitter),p.__signal_exit_emitter__?m=p.__signal_exit_emitter__:(m=p.__signal_exit_emitter__=new O,m.count=0,m.emitted={}),m.infinite||(m.setMaxListeners(1/0),m.infinite=!0),G.exports=function(e,t){if(!I(global.process))return function(){};qt.equal(typeof e,"function","a callback must be provided for exit handler"),$===!1&&he();var n="exit";t&&t.alwaysLast&&(n="afterexit");var r=function(){m.removeListener(n,e),m.listeners("exit").length===0&&m.listeners("afterexit").length===0&&z()};return m.on(n,e),r},z=function(){!$||!I(global.process)||($=!1,D.forEach(function(t){try{p.removeListener(t,J[t])}catch{}}),p.emit=Z,p.reallyExit=ge,m.count-=1)},G.exports.unload=z,b=function(t,n,r){m.emitted[t]||(m.emitted[t]=!0,m.emit(t,n,r))},J={},D.forEach(function(e){J[e]=function(){if(!!I(global.process)){var n=p.listeners(e);n.length===m.count&&(z(),b("exit",null,e),b("afterexit",null,e),Lt&&e==="SIGHUP"&&(e="SIGINT"),p.kill(p.pid,e))}}}),G.exports.signals=function(){return D},$=!1,he=function(){$||!I(global.process)||($=!0,m.count+=1,D=D.filter(function(t){try{return p.on(t,J[t]),!0}catch{return!1}}),p.emit=_t,p.reallyExit=Mt)},G.exports.load=he,ge=p.reallyExit,Mt=function(t){!I(global.process)||(p.exitCode=t||0,b("exit",p.exitCode,null),b("afterexit",p.exitCode,null),ge.call(p,p.exitCode))},Z=p.emit,_t=function(t,n){if(t==="exit"&&I(global.process)){n!==void 0&&(p.exitCode=n);var r=Z.apply(this,arguments);return b("exit",p.exitCode,null),b("afterexit",p.exitCode,null),r}else return Z.apply(this,arguments)}):G.exports=function(){return function(){}};var qt,D,Lt,O,m,z,b,J,$,he,ge,Mt,Z,_t});var Wt=l((Yo,Ut)=>{"use strict";var wr=require("os"),Ir=jt(),br=1e3*5,vr=(e,t="SIGTERM",n={})=>{let r=e(t);return Er(e,t,n,r),r},Er=(e,t,n,r)=>{if(!Tr(t,n,r))return;let o=Fr(n),s=setTimeout(()=>{e("SIGKILL")},o);s.unref&&s.unref()},Tr=(e,{forceKillAfterTimeout:t},n)=>Cr(e)&&t!==!1&&n,Cr=e=>e===wr.constants.signals.SIGTERM||typeof e=="string"&&e.toUpperCase()==="SIGTERM",Fr=({forceKillAfterTimeout:e=!0})=>{if(e===!0)return br;if(!Number.isFinite(e)||e<0)throw new TypeError(`Expected the \`forceKillAfterTimeout\` option to be a non-negative integer, got \`${e}\` (${typeof e})`);return e},Dr=(e,t)=>{e.kill()&&(t.isCanceled=!0)},$r=(e,t,n)=>{e.kill(t),n(Object.assign(new Error("Timed out"),{timedOut:!0,signal:t}))},Gr=(e,{timeout:t,killSignal:n="SIGTERM"},r)=>{if(t===0||t===void 0)return r;let o,s=new Promise((a,c)=>{o=setTimeout(()=>{$r(e,n,c)},t)}),i=r.finally(()=>{clearTimeout(o)});return Promise.race([s,i])},Ar=({timeout:e})=>{if(e!==void 0&&(!Number.isFinite(e)||e<0))throw new TypeError(`Expected the \`timeout\` option to be a non-negative integer, got \`${e}\` (${typeof e})`)},Rr=async(e,{cleanup:t,detached:n},r)=>{if(!t||n)return r;let o=Ir(()=>{e.kill()});return r.finally(()=>{o()})};Ut.exports={spawnedKill:vr,spawnedCancel:Dr,setupTimeout:Gr,validateTimeout:Ar,setExitHandler:Rr}});var Ht=l((Qo,Xt)=>{"use strict";var w=e=>e!==null&&typeof e=="object"&&typeof e.pipe=="function";w.writable=e=>w(e)&&e.writable!==!1&&typeof e._write=="function"&&typeof e._writableState=="object";w.readable=e=>w(e)&&e.readable!==!1&&typeof e._read=="function"&&typeof e._readableState=="object";w.duplex=e=>w.writable(e)&&w.readable(e);w.transform=e=>w.duplex(e)&&typeof e._transform=="function";Xt.exports=w});var Kt=l((es,Vt)=>{"use strict";var{PassThrough:Nr}=require("stream");Vt.exports=e=>{e={...e};let{array:t}=e,{encoding:n}=e,r=n==="buffer",o=!1;t?o=!(n||r):n=n||"utf8",r&&(n=null);let s=new Nr({objectMode:o});n&&s.setEncoding(n);let i=0,a=[];return s.on("data",c=>{a.push(c),o?i=a.length:i+=c.length}),s.getBufferedValue=()=>t?a:r?Buffer.concat(a,i):a.join(""),s.getBufferedLength=()=>i,s}});var zt=l((ts,B)=>{"use strict";var{constants:Or}=require("buffer"),Br=require("stream"),{promisify:kr}=require("util"),qr=Kt(),Lr=kr(Br.pipeline),Y=class extends Error{constructor(){super("maxBuffer exceeded"),this.name="MaxBufferError"}};async function Se(e,t){if(!e)throw new Error("Expected a stream");t={maxBuffer:1/0,...t};let{maxBuffer:n}=t,r=qr(t);return await new Promise((o,s)=>{let i=a=>{a&&r.getBufferedLength()<=Or.MAX_LENGTH&&(a.bufferedData=r.getBufferedValue()),s(a)};(async()=>{try{await Lr(e,r),o()}catch(a){i(a)}})(),r.on("data",()=>{r.getBufferedLength()>n&&i(new Y)})}),r.getBufferedValue()}B.exports=Se;B.exports.buffer=(e,t)=>Se(e,{...t,encoding:"buffer"});B.exports.array=(e,t)=>Se(e,{...t,array:!0});B.exports.MaxBufferError=Y});var Zt=l((ns,Jt)=>{"use strict";var{PassThrough:Mr}=require("stream");Jt.exports=function(){var e=[],t=new Mr({objectMode:!0});return t.setMaxListeners(0),t.add=n,t.isEmpty=r,t.on("unpipe",o),Array.prototype.slice.call(arguments).forEach(n),t;function n(s){return Array.isArray(s)?(s.forEach(n),this):(e.push(s),s.once("end",o.bind(null,s)),s.once("error",t.emit.bind(t,"error")),s.pipe(t,{end:!1}),this)}function r(){return e.length==0}function o(s){e=e.filter(function(i){return i!==s}),!e.length&&t.readable&&t.end()}}});var tn=l((rs,en)=>{"use strict";var Qt=Ht(),Yt=zt(),_r=Zt(),jr=(e,t)=>{t===void 0||e.stdin===void 0||(Qt(t)?t.pipe(e.stdin):e.stdin.end(t))},Ur=(e,{all:t})=>{if(!t||!e.stdout&&!e.stderr)return;let n=_r();return e.stdout&&n.add(e.stdout),e.stderr&&n.add(e.stderr),n},ye=async(e,t)=>{if(!!e){e.destroy();try{return await t}catch(n){return n.bufferedData}}},Pe=(e,{encoding:t,buffer:n,maxBuffer:r})=>{if(!(!e||!n))return t?Yt(e,{encoding:t,maxBuffer:r}):Yt.buffer(e,{maxBuffer:r})},Wr=async({stdout:e,stderr:t,all:n},{encoding:r,buffer:o,maxBuffer:s},i)=>{let a=Pe(e,{encoding:r,buffer:o,maxBuffer:s}),c=Pe(t,{encoding:r,buffer:o,maxBuffer:s}),u=Pe(n,{encoding:r,buffer:o,maxBuffer:s*2});try{return await Promise.all([i,a,c,u])}catch(f){return Promise.all([{error:f,signal:f.signal,timedOut:f.timedOut},ye(e,a),ye(t,c),ye(n,u)])}},Xr=({input:e})=>{if(Qt(e))throw new TypeError("The `input` option cannot be a stream in sync mode")};en.exports={handleInput:jr,makeAllStream:Ur,getSpawnedResult:Wr,validateInputSync:Xr}});var rn=l((os,nn)=>{"use strict";var Hr=(async()=>{})().constructor.prototype,Vr=["then","catch","finally"].map(e=>[e,Reflect.getOwnPropertyDescriptor(Hr,e)]),Kr=(e,t)=>{for(let[n,r]of Vr){let o=typeof t=="function"?(...s)=>Reflect.apply(r.value,t(),s):r.value.bind(t);Reflect.defineProperty(e,n,{...r,value:o})}return e},zr=e=>new Promise((t,n)=>{e.on("exit",(r,o)=>{t({exitCode:r,signal:o})}),e.on("error",r=>{n(r)}),e.stdin&&e.stdin.on("error",r=>{n(r)})});nn.exports={mergePromise:Kr,getSpawnedPromise:zr}});var an=l((ss,sn)=>{"use strict";var on=(e,t=[])=>Array.isArray(t)?[e,...t]:[e],Jr=/^[\w.-]+$/,Zr=/"/g,Yr=e=>typeof e!="string"||Jr.test(e)?e:`"${e.replace(Zr,'\\"')}"`,Qr=(e,t)=>on(e,t).join(" "),eo=(e,t)=>on(e,t).map(n=>Yr(n)).join(" "),to=/ +/g,no=e=>{let t=[];for(let n of e.trim().split(to)){let r=t[t.length-1];r&&r.endsWith("\\")?t[t.length-1]=`${r.slice(0,-1)} ${n}`:t.push(n)}return t};sn.exports={joinCommand:Qr,getEscapedCommand:eo,parseCommand:no}});var mn=l((is,A)=>{"use strict";var ro=require("path"),xe=require("child_process"),oo=St(),so=Pt(),io=It(),ao=Tt(),Q=Nt(),un=Bt(),{spawnedKill:co,spawnedCancel:uo,setupTimeout:lo,validateTimeout:po,setExitHandler:fo}=Wt(),{handleInput:mo,getSpawnedResult:ho,makeAllStream:go,validateInputSync:So}=tn(),{mergePromise:cn,getSpawnedPromise:yo}=rn(),{joinCommand:ln,parseCommand:dn,getEscapedCommand:pn}=an(),Po=1e3*1e3*100,xo=({env:e,extendEnv:t,preferLocal:n,localDir:r,execPath:o})=>{let s=t?{...process.env,...e}:e;return n?io.env({env:s,cwd:r,execPath:o}):s},fn=(e,t,n={})=>{let r=oo._parse(e,t,n);return e=r.command,t=r.args,n=r.options,n={maxBuffer:Po,buffer:!0,stripFinalNewline:!0,extendEnv:!0,preferLocal:!1,localDir:n.cwd||process.cwd(),execPath:process.execPath,encoding:"utf8",reject:!0,cleanup:!0,all:!1,windowsHide:!0,...n},n.env=xo(n),n.stdio=un(n),process.platform==="win32"&&ro.basename(e,".exe")==="cmd"&&t.unshift("/q"),{file:e,args:t,options:n,parsed:r}},k=(e,t,n)=>typeof t!="string"&&!Buffer.isBuffer(t)?n===void 0?void 0:"":e.stripFinalNewline?so(t):t,ee=(e,t,n)=>{let r=fn(e,t,n),o=ln(e,t),s=pn(e,t);po(r.options);let i;try{i=xe.spawn(r.file,r.args,r.options)}catch(S){let y=new xe.ChildProcess,x=Promise.reject(Q({error:S,stdout:"",stderr:"",all:"",command:o,escapedCommand:s,parsed:r,timedOut:!1,isCanceled:!1,killed:!1}));return cn(y,x)}let a=yo(i),c=lo(i,r.options,a),u=fo(i,r.options,c),f={isCanceled:!1};i.kill=co.bind(null,i.kill.bind(i)),i.cancel=uo.bind(null,i,f);let h=ao(async()=>{let[{error:S,exitCode:y,signal:x,timedOut:v},L,M,Pn]=await ho(i,r.options,u),Ee=k(r.options,L),Te=k(r.options,M),Ce=k(r.options,Pn);if(S||y!==0||x!==null){let Fe=Q({error:S,exitCode:y,signal:x,stdout:Ee,stderr:Te,all:Ce,command:o,escapedCommand:s,parsed:r,timedOut:v,isCanceled:f.isCanceled,killed:i.killed});if(!r.options.reject)return Fe;throw Fe}return{command:o,escapedCommand:s,exitCode:0,stdout:Ee,stderr:Te,all:Ce,failed:!1,timedOut:!1,isCanceled:!1,killed:!1}});return mo(i,r.options.input),i.all=go(i,r.options),cn(i,h)};A.exports=ee;A.exports.sync=(e,t,n)=>{let r=fn(e,t,n),o=ln(e,t),s=pn(e,t);So(r.options);let i;try{i=xe.spawnSync(r.file,r.args,r.options)}catch(u){throw Q({error:u,stdout:"",stderr:"",all:"",command:o,escapedCommand:s,parsed:r,timedOut:!1,isCanceled:!1,killed:!1})}let a=k(r.options,i.stdout,i.error),c=k(r.options,i.stderr,i.error);if(i.error||i.status!==0||i.signal!==null){let u=Q({stdout:a,stderr:c,error:i.error,signal:i.signal,exitCode:i.status,command:o,escapedCommand:s,parsed:r,timedOut:i.error&&i.error.code==="ETIMEDOUT",isCanceled:!1,killed:i.signal!==null});if(!r.options.reject)return u;throw u}return{command:o,escapedCommand:s,exitCode:0,stdout:a,stderr:c,failed:!1,timedOut:!1,isCanceled:!1,killed:!1}};A.exports.command=(e,t)=>{let[n,...r]=dn(e);return ee(n,r,t)};A.exports.commandSync=(e,t)=>{let[n,...r]=dn(e);return ee.sync(n,r,t)};A.exports.node=(e,t,n={})=>{t&&!Array.isArray(t)&&typeof t=="object"&&(n=t,t=[]);let r=un.node(n),o=process.execArgv.filter(a=>!a.startsWith("--inspect")),{nodePath:s=process.execPath,nodeOptions:i=o}=n;return ee(s,[...i,e,...Array.isArray(t)?t:[]],{...n,stdin:void 0,stdout:void 0,stderr:void 0,stdio:r,shell:!1})}});var vo={};En(vo,{default:()=>yn});module.exports=Tn(vo);var d=require("@raycast/api"),P=require("child_process");var q=require("@raycast/api");var we=$e(require("node:process"),1),Ie=$e(mn(),1);async function be(e,{humanReadableOutput:t=!0}={}){if(we.default.platform!=="darwin")throw new Error("macOS only");let n=t?[]:["-ss"],{stdout:r}=await(0,Ie.default)("osascript",["-e",e,n]);return r}function ve(e,{humanReadableOutput:t=!0}={}){if(we.default.platform!=="darwin")throw new Error("macOS only");let n=t?[]:["-ss"],{stdout:r}=Ie.default.sync("osascript",["-e",e,...n]);return r}var wo=async()=>be(`set imageTypes to {"PNG", "JPG", "JPEG", "TIF", "HEIF", "GIF", "ICO", "ICNS", "ASTC", "BMP", "DDS", "EXR", "JP2", "KTX", "Portable Bitmap", "Adobe Photoshop", "PVR", "TGA", "WebP", "SVG", "PDF", "HEIC"}

    tell application "Finder"
      set theSelection to selection
      if theSelection is {} then
        return
      else if (theSelection count) is equal to 1 then
        repeat with imageType in imageTypes
          if (kind of the first item of theSelection) contains imageType then
            return the POSIX path of (theSelection as alias)
            exit repeat
          end if
        end repeat
      else
        set thePaths to {}
        repeat with i from 1 to (theSelection count)
          repeat with imageType in imageTypes
            if (kind of (item i of theSelection)) contains imageType then
              copy (POSIX path of (item i of theSelection as alias)) to end of thePaths
              exit repeat
            end if
          end repeat
        end repeat
        return thePaths
      end if
    end tell`),Io=async()=>be(`set imageTypes to {"PNG", "JPG", "JPEG", "TIF", "HEIF", "GIF", "ICO", "ICNS", "ASTC", "BMP", "DDS", "EXR", "JP2", "KTX", "Portable Bitmap", "Adobe Photoshop", "PVR", "TGA", "WebP", "SVG", "PDF", "HEIC"}

    tell application "Path Finder"
      set theSelection to selection
      if theSelection is {} then
        return
      else if (theSelection count) is equal to 1 then
        repeat with imageType in imageTypes
          if (kind of the first item of theSelection) contains imageType then
            return the POSIX path of first item of theSelection
            exit repeat
          end if
        end repeat
      else
        set thePaths to {}
        repeat with i from 1 to (theSelection count)
          repeat with imageType in imageTypes
            if (kind of (item i of theSelection)) contains imageType then
              copy (POSIX path of (item i of theSelection)) to end of thePaths
              exit repeat
            end if
          end repeat
        end repeat
        return thePaths
      end if
    end tell`),hn=async()=>{let e=[],n=(0,q.getPreferenceValues)().preferredFileManager,r=!1,o=n;try{o=(await(0,q.getFrontmostApplication)()).name}catch{console.log("Couldn't get frontmost application")}try{o=="Path Finder"&&n=="Path Finder"&&(await Io()).split(", ").forEach(a=>{e.includes(a)||e.push(a)})}catch{console.log("Couldn't get images from Path Finder"),r=!0}let s=(await wo()).split(", ");return o=="Finder"||n=="Finder"||r?e.push(...s):s.forEach(i=>{i.split("/").at(-2)=="Desktop"&&!e.includes(i)&&e.push(i)}),e};var gn=(e,t,n)=>{ve(`use framework "Foundation"

  -- Load SVG image from file
  set svgFilePath to "${t}"
  set svgData to current application's NSData's alloc()'s initWithContentsOfFile:svgFilePath
  
  -- Create image from SVG data
  set svgImage to current application's NSImage's alloc()'s initWithData:svgData
  
  -- Convert image to PNG data
  set tiffData to svgImage's TIFFRepresentation()
  set theBitmap to current application's NSBitmapImageRep's alloc()'s initWithData:tiffData
  set pngData to theBitmap's representationUsingType:(current application's NSBitmapImageFileType${e}) |properties|:(missing value)
  
  -- Save PNG data to file
  set pngFilePath to "${n}"
  pngData's writeToFile:pngFilePath atomically:true`)},Sn=(e,t,n)=>{ve(`use framework "Foundation"
  use framework "PDFKit"
  
  -- Load the PDF file as NSData
  set pdfData to current application's NSData's dataWithContentsOfFile:"${t}"
  
  -- Create a PDFDocument from the PDF data
  set pdfDoc to current application's PDFDocument's alloc()'s initWithData:pdfData
  
  set pageCount to (pdfDoc's pageCount()) - 1
  repeat with pageIndex from 0 to pageCount
    -- Create an NSImage from each page of the PDF document
    set pdfPage to (pdfDoc's pageAtIndex:pageIndex)
    set pdfRect to (pdfPage's boundsForBox:(current application's kPDFDisplayBoxMediaBox))
    set pdfImage to (current application's NSImage's alloc()'s initWithSize:{item 1 of item 2 of pdfRect, item 2 of item 2 of pdfRect})
    pdfImage's lockFocus()
    (pdfPage's drawWithBox:(current application's kPDFDisplayBoxMediaBox))
    pdfImage's unlockFocus()
    
    -- Convert the NSImage to PNG data
    set pngData to pdfImage's TIFFRepresentation()
    set pngRep to (current application's NSBitmapImageRep's imageRepWithData:pngData)
    set pngData to (pngRep's representationUsingType:(current application's NSPNGFileType) |properties|:(missing value))
    
    -- Write the PNG data to a new file
    pngData's writeToFile:"${n}/page-" & pageIndex + 1 & ".${e.toLowerCase()}" atomically:true
  end repeat`)};var te=require("react/jsx-runtime"),bo=["ASTC","BMP","DDS","EXR","GIF","HEIC","HEICS","ICNS","ICO","JPEG","JP2","KTX","PBM","PDF","PNG","PSD","PVR","TGA","TIFF","WEBP","SVG"];function yn(){let e=async t=>{let n=await hn();if(n.length===0||n.length===1&&n[0]===""){await(0,d.showToast)({title:"No images selected",style:d.Toast.Style.Failure});return}let r=await(0,d.showToast)({title:"Conversion in progress...",style:d.Toast.Style.Animated}),o=`image${n.length===1?"":"s"}`;try{n.forEach(s=>{let i=s.split("."),a=i.slice(0,-1).join("")+"."+t.toLowerCase();if(t==="WEBP")(0,P.execSync)(`chmod +x ${d.environment.assetsPath}/webp/cwebp`),(0,P.execSync)(`${d.environment.assetsPath}/webp/cwebp "${s}" -o "${a}"`);else if(i.at(-1)?.toLowerCase()=="svg")gn(t,s,a);else if(t=="SVG"){let c=`${d.environment.supportPath}/tmp.bmp`;if((0,P.execSync)(`chmod +x ${d.environment.assetsPath}/potrace/potrace`),i.at(-1)?.toLowerCase()=="webp"){let u=`${d.environment.supportPath}/tmp.png`;(0,P.execSync)(`chmod +x ${d.environment.assetsPath}/webp/dwebp`),(0,P.execSync)(`${d.environment.assetsPath}/webp/dwebp "${s}" -o "${u}"`),(0,P.execSync)(`sips --setProperty format "bmp" "${u}" --out "${c}" && ${d.environment.assetsPath}/potrace/potrace -s --tight -o "${a}" "${c}"; rm "${c}"; rm "${u}"`)}else(0,P.execSync)(`sips --setProperty format "bmp" "${s}" --out "${c}" && ${d.environment.assetsPath}/potrace/potrace -s --tight -o "${a}" "${c}"; rm "${c}"`)}else if(i.at(-1)?.toLowerCase()=="webp")(0,P.execSync)(`chmod +x ${d.environment.assetsPath}/webp/dwebp`),(0,P.execSync)(`${d.environment.assetsPath}/webp/dwebp "${s}" -o "${a}"`);else if(i.at(-1)?.toLowerCase()=="pdf"){let c=s.split("/").at(-1),u=`${c?.substring(0,c.lastIndexOf("."))} ${t}`,f=`${s.split("/").slice(0,-1).join("/")+"/"+u}`;(0,P.execSync)(`mkdir "${f}"`),Sn(t,s,f)}else(0,P.execSync)(`sips --setProperty format ${t.toLowerCase()} "${s}" --out "${a}"`)}),r.title=`Converted ${n.length.toString()} ${o} to ${t}`,r.style=d.Toast.Style.Success}catch(s){console.log(s),r.title=`Failed to convert ${n.length.toString()} ${o} to ${t}`,r.style=d.Toast.Style.Failure}};return(0,te.jsx)(d.List,{searchBarPlaceholder:"Search image transformations...",children:bo.map(t=>(0,te.jsx)(d.List.Item,{title:t,actions:(0,te.jsx)(d.ActionPanel,{children:(0,te.jsx)(d.Action,{title:`Convert to ${t}`,onAction:async()=>await e(t)})})},t))})}0&&(module.exports={});
