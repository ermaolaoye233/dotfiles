"use strict";var wn=Object.create;var U=Object.defineProperty;var Pn=Object.getOwnPropertyDescriptor;var In=Object.getOwnPropertyNames;var bn=Object.getPrototypeOf,vn=Object.prototype.hasOwnProperty;var l=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),En=(e,t)=>{for(var r in t)U(e,r,{get:t[r],enumerable:!0})},$e=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of In(t))!vn.call(e,s)&&s!==r&&U(e,s,{get:()=>t[s],enumerable:!(n=Pn(t,s))||n.enumerable});return e};var Ge=(e,t,r)=>(r=e!=null?wn(bn(e)):{},$e(t||!e||!e.__esModule?U(r,"default",{value:e,enumerable:!0}):r,e)),Tn=e=>$e(U({},"__esModule",{value:!0}),e);var Be=l((Es,Oe)=>{Oe.exports=Re;Re.sync=Cn;var Ae=require("fs");function Fn(e,t){var r=t.pathExt!==void 0?t.pathExt:process.env.PATHEXT;if(!r||(r=r.split(";"),r.indexOf("")!==-1))return!0;for(var n=0;n<r.length;n++){var s=r[n].toLowerCase();if(s&&e.substr(-s.length).toLowerCase()===s)return!0}return!1}function Ne(e,t,r){return!e.isSymbolicLink()&&!e.isFile()?!1:Fn(t,r)}function Re(e,t,r){Ae.stat(e,function(n,s){r(n,n?!1:Ne(s,e,t))})}function Cn(e,t){return Ne(Ae.statSync(e),e,t)}});var _e=l((Ts,Me)=>{Me.exports=qe;qe.sync=Dn;var ke=require("fs");function qe(e,t,r){ke.stat(e,function(n,s){r(n,n?!1:Le(s,t))})}function Dn(e,t){return Le(ke.statSync(e),t)}function Le(e,t){return e.isFile()&&$n(e,t)}function $n(e,t){var r=e.mode,n=e.uid,s=e.gid,i=t.uid!==void 0?t.uid:process.getuid&&process.getuid(),o=t.gid!==void 0?t.gid:process.getgid&&process.getgid(),a=parseInt("100",8),u=parseInt("010",8),c=parseInt("001",8),p=a|u,h=r&c||r&u&&s===o||r&a&&n===i||r&p&&i===0;return h}});var je=l((Cs,We)=>{var Fs=require("fs"),H;process.platform==="win32"||global.TESTING_WINDOWS?H=Be():H=_e();We.exports=se;se.sync=Gn;function se(e,t,r){if(typeof t=="function"&&(r=t,t={}),!r){if(typeof Promise!="function")throw new TypeError("callback not provided");return new Promise(function(n,s){se(e,t||{},function(i,o){i?s(i):n(o)})})}H(e,t||{},function(n,s){n&&(n.code==="EACCES"||t&&t.ignoreErrors)&&(n=null,s=!1),r(n,s)})}function Gn(e,t){try{return H.sync(e,t||{})}catch(r){if(t&&t.ignoreErrors||r.code==="EACCES")return!1;throw r}}});var Je=l((Ds,ze)=>{var T=process.platform==="win32"||process.env.OSTYPE==="cygwin"||process.env.OSTYPE==="msys",Ue=require("path"),An=T?";":":",He=je(),Xe=e=>Object.assign(new Error(`not found: ${e}`),{code:"ENOENT"}),Ve=(e,t)=>{let r=t.colon||An,n=e.match(/\//)||T&&e.match(/\\/)?[""]:[...T?[process.cwd()]:[],...(t.path||process.env.PATH||"").split(r)],s=T?t.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM":"",i=T?s.split(r):[""];return T&&e.indexOf(".")!==-1&&i[0]!==""&&i.unshift(""),{pathEnv:n,pathExt:i,pathExtExe:s}},Ke=(e,t,r)=>{typeof t=="function"&&(r=t,t={}),t||(t={});let{pathEnv:n,pathExt:s,pathExtExe:i}=Ve(e,t),o=[],a=c=>new Promise((p,h)=>{if(c===n.length)return t.all&&o.length?p(o):h(Xe(e));let m=n[c],y=/^".*"$/.test(m)?m.slice(1,-1):m,x=Ue.join(y,e),w=!y&&/^\.[\\\/]/.test(e)?e.slice(0,2)+x:x;p(u(w,c,0))}),u=(c,p,h)=>new Promise((m,y)=>{if(h===s.length)return m(a(p+1));let x=s[h];He(c+x,{pathExt:i},(w,E)=>{if(!w&&E)if(t.all)o.push(c+x);else return m(c+x);return m(u(c,p,h+1))})});return r?a(0).then(c=>r(null,c),r):a(0)},Nn=(e,t)=>{t=t||{};let{pathEnv:r,pathExt:n,pathExtExe:s}=Ve(e,t),i=[];for(let o=0;o<r.length;o++){let a=r[o],u=/^".*"$/.test(a)?a.slice(1,-1):a,c=Ue.join(u,e),p=!u&&/^\.[\\\/]/.test(e)?e.slice(0,2)+c:c;for(let h=0;h<n.length;h++){let m=p+n[h];try{if(He.sync(m,{pathExt:s}))if(t.all)i.push(m);else return m}catch{}}}if(t.all&&i.length)return i;if(t.nothrow)return null;throw Xe(e)};ze.exports=Ke;Ke.sync=Nn});var oe=l(($s,ie)=>{"use strict";var Ze=(e={})=>{let t=e.env||process.env;return(e.platform||process.platform)!=="win32"?"PATH":Object.keys(t).reverse().find(n=>n.toUpperCase()==="PATH")||"Path"};ie.exports=Ze;ie.exports.default=Ze});var tt=l((Gs,et)=>{"use strict";var Ye=require("path"),Rn=Je(),On=oe();function Qe(e,t){let r=e.options.env||process.env,n=process.cwd(),s=e.options.cwd!=null,i=s&&process.chdir!==void 0&&!process.chdir.disabled;if(i)try{process.chdir(e.options.cwd)}catch{}let o;try{o=Rn.sync(e.command,{path:r[On({env:r})],pathExt:t?Ye.delimiter:void 0})}catch{}finally{i&&process.chdir(n)}return o&&(o=Ye.resolve(s?e.options.cwd:"",o)),o}function Bn(e){return Qe(e)||Qe(e,!0)}et.exports=Bn});var nt=l((As,ce)=>{"use strict";var ae=/([()\][%!^"`<>&|;, *?])/g;function kn(e){return e=e.replace(ae,"^$1"),e}function qn(e,t){return e=`${e}`,e=e.replace(/(\\*)"/g,'$1$1\\"'),e=e.replace(/(\\*)$/,"$1$1"),e=`"${e}"`,e=e.replace(ae,"^$1"),t&&(e=e.replace(ae,"^$1")),e}ce.exports.command=kn;ce.exports.argument=qn});var st=l((Ns,rt)=>{"use strict";rt.exports=/^#!(.*)/});var ot=l((Rs,it)=>{"use strict";var Ln=st();it.exports=(e="")=>{let t=e.match(Ln);if(!t)return null;let[r,n]=t[0].replace(/#! ?/,"").split(" "),s=r.split("/").pop();return s==="env"?n:n?`${s} ${n}`:s}});var ct=l((Os,at)=>{"use strict";var ue=require("fs"),Mn=ot();function _n(e){let r=Buffer.alloc(150),n;try{n=ue.openSync(e,"r"),ue.readSync(n,r,0,150,0),ue.closeSync(n)}catch{}return Mn(r.toString())}at.exports=_n});var pt=l((Bs,dt)=>{"use strict";var Wn=require("path"),ut=tt(),lt=nt(),jn=ct(),Un=process.platform==="win32",Hn=/\.(?:com|exe)$/i,Xn=/node_modules[\\/].bin[\\/][^\\/]+\.cmd$/i;function Vn(e){e.file=ut(e);let t=e.file&&jn(e.file);return t?(e.args.unshift(e.file),e.command=t,ut(e)):e.file}function Kn(e){if(!Un)return e;let t=Vn(e),r=!Hn.test(t);if(e.options.forceShell||r){let n=Xn.test(t);e.command=Wn.normalize(e.command),e.command=lt.command(e.command),e.args=e.args.map(i=>lt.argument(i,n));let s=[e.command].concat(e.args).join(" ");e.args=["/d","/s","/c",`"${s}"`],e.command=process.env.comspec||"cmd.exe",e.options.windowsVerbatimArguments=!0}return e}function zn(e,t,r){t&&!Array.isArray(t)&&(r=t,t=null),t=t?t.slice(0):[],r=Object.assign({},r);let n={command:e,args:t,options:r,file:void 0,original:{command:e,args:t}};return r.shell?n:Kn(n)}dt.exports=zn});var ht=l((ks,mt)=>{"use strict";var le=process.platform==="win32";function de(e,t){return Object.assign(new Error(`${t} ${e.command} ENOENT`),{code:"ENOENT",errno:"ENOENT",syscall:`${t} ${e.command}`,path:e.command,spawnargs:e.args})}function Jn(e,t){if(!le)return;let r=e.emit;e.emit=function(n,s){if(n==="exit"){let i=ft(s,t,"spawn");if(i)return r.call(e,"error",i)}return r.apply(e,arguments)}}function ft(e,t){return le&&e===1&&!t.file?de(t.original,"spawn"):null}function Zn(e,t){return le&&e===1&&!t.file?de(t.original,"spawnSync"):null}mt.exports={hookChildProcess:Jn,verifyENOENT:ft,verifyENOENTSync:Zn,notFoundError:de}});var yt=l((qs,F)=>{"use strict";var gt=require("child_process"),pe=pt(),fe=ht();function St(e,t,r){let n=pe(e,t,r),s=gt.spawn(n.command,n.args,n.options);return fe.hookChildProcess(s,n),s}function Yn(e,t,r){let n=pe(e,t,r),s=gt.spawnSync(n.command,n.args,n.options);return s.error=s.error||fe.verifyENOENTSync(s.status,n),s}F.exports=St;F.exports.spawn=St;F.exports.sync=Yn;F.exports._parse=pe;F.exports._enoent=fe});var wt=l((Ls,xt)=>{"use strict";xt.exports=e=>{let t=typeof e=="string"?`
`:`
`.charCodeAt(),r=typeof e=="string"?"\r":"\r".charCodeAt();return e[e.length-1]===t&&(e=e.slice(0,e.length-1)),e[e.length-1]===r&&(e=e.slice(0,e.length-1)),e}});var bt=l((Ms,B)=>{"use strict";var O=require("path"),Pt=oe(),It=e=>{e={cwd:process.cwd(),path:process.env[Pt()],execPath:process.execPath,...e};let t,r=O.resolve(e.cwd),n=[];for(;t!==r;)n.push(O.join(r,"node_modules/.bin")),t=r,r=O.resolve(r,"..");let s=O.resolve(e.cwd,e.execPath,"..");return n.push(s),n.concat(e.path).join(O.delimiter)};B.exports=It;B.exports.default=It;B.exports.env=e=>{e={env:process.env,...e};let t={...e.env},r=Pt({env:t});return e.path=t[r],t[r]=B.exports(e),t}});var Et=l((_s,me)=>{"use strict";var vt=(e,t)=>{for(let r of Reflect.ownKeys(t))Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));return e};me.exports=vt;me.exports.default=vt});var Ft=l((Ws,V)=>{"use strict";var Qn=Et(),X=new WeakMap,Tt=(e,t={})=>{if(typeof e!="function")throw new TypeError("Expected a function");let r,n=0,s=e.displayName||e.name||"<anonymous>",i=function(...o){if(X.set(i,++n),n===1)r=e.apply(this,o),e=null;else if(t.throw===!0)throw new Error(`Function \`${s}\` can only be called once`);return r};return Qn(i,e),X.set(i,n),i};V.exports=Tt;V.exports.default=Tt;V.exports.callCount=e=>{if(!X.has(e))throw new Error(`The given function \`${e.name}\` is not wrapped by the \`onetime\` package`);return X.get(e)}});var Ct=l(K=>{"use strict";Object.defineProperty(K,"__esModule",{value:!0});K.SIGNALS=void 0;var er=[{name:"SIGHUP",number:1,action:"terminate",description:"Terminal closed",standard:"posix"},{name:"SIGINT",number:2,action:"terminate",description:"User interruption with CTRL-C",standard:"ansi"},{name:"SIGQUIT",number:3,action:"core",description:"User interruption with CTRL-\\",standard:"posix"},{name:"SIGILL",number:4,action:"core",description:"Invalid machine instruction",standard:"ansi"},{name:"SIGTRAP",number:5,action:"core",description:"Debugger breakpoint",standard:"posix"},{name:"SIGABRT",number:6,action:"core",description:"Aborted",standard:"ansi"},{name:"SIGIOT",number:6,action:"core",description:"Aborted",standard:"bsd"},{name:"SIGBUS",number:7,action:"core",description:"Bus error due to misaligned, non-existing address or paging error",standard:"bsd"},{name:"SIGEMT",number:7,action:"terminate",description:"Command should be emulated but is not implemented",standard:"other"},{name:"SIGFPE",number:8,action:"core",description:"Floating point arithmetic error",standard:"ansi"},{name:"SIGKILL",number:9,action:"terminate",description:"Forced termination",standard:"posix",forced:!0},{name:"SIGUSR1",number:10,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGSEGV",number:11,action:"core",description:"Segmentation fault",standard:"ansi"},{name:"SIGUSR2",number:12,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGPIPE",number:13,action:"terminate",description:"Broken pipe or socket",standard:"posix"},{name:"SIGALRM",number:14,action:"terminate",description:"Timeout or timer",standard:"posix"},{name:"SIGTERM",number:15,action:"terminate",description:"Termination",standard:"ansi"},{name:"SIGSTKFLT",number:16,action:"terminate",description:"Stack is empty or overflowed",standard:"other"},{name:"SIGCHLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"posix"},{name:"SIGCLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"other"},{name:"SIGCONT",number:18,action:"unpause",description:"Unpaused",standard:"posix",forced:!0},{name:"SIGSTOP",number:19,action:"pause",description:"Paused",standard:"posix",forced:!0},{name:"SIGTSTP",number:20,action:"pause",description:'Paused using CTRL-Z or "suspend"',standard:"posix"},{name:"SIGTTIN",number:21,action:"pause",description:"Background process cannot read terminal input",standard:"posix"},{name:"SIGBREAK",number:21,action:"terminate",description:"User interruption with CTRL-BREAK",standard:"other"},{name:"SIGTTOU",number:22,action:"pause",description:"Background process cannot write to terminal output",standard:"posix"},{name:"SIGURG",number:23,action:"ignore",description:"Socket received out-of-band data",standard:"bsd"},{name:"SIGXCPU",number:24,action:"core",description:"Process timed out",standard:"bsd"},{name:"SIGXFSZ",number:25,action:"core",description:"File too big",standard:"bsd"},{name:"SIGVTALRM",number:26,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGPROF",number:27,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGWINCH",number:28,action:"ignore",description:"Terminal window size changed",standard:"bsd"},{name:"SIGIO",number:29,action:"terminate",description:"I/O is available",standard:"other"},{name:"SIGPOLL",number:29,action:"terminate",description:"Watched event",standard:"other"},{name:"SIGINFO",number:29,action:"ignore",description:"Request for process information",standard:"other"},{name:"SIGPWR",number:30,action:"terminate",description:"Device running out of power",standard:"systemv"},{name:"SIGSYS",number:31,action:"core",description:"Invalid system call",standard:"other"},{name:"SIGUNUSED",number:31,action:"terminate",description:"Invalid system call",standard:"other"}];K.SIGNALS=er});var he=l(C=>{"use strict";Object.defineProperty(C,"__esModule",{value:!0});C.SIGRTMAX=C.getRealtimeSignals=void 0;var tr=function(){let e=$t-Dt+1;return Array.from({length:e},nr)};C.getRealtimeSignals=tr;var nr=function(e,t){return{name:`SIGRT${t+1}`,number:Dt+t,action:"terminate",description:"Application-specific signal (realtime)",standard:"posix"}},Dt=34,$t=64;C.SIGRTMAX=$t});var Gt=l(z=>{"use strict";Object.defineProperty(z,"__esModule",{value:!0});z.getSignals=void 0;var rr=require("os"),sr=Ct(),ir=he(),or=function(){let e=(0,ir.getRealtimeSignals)();return[...sr.SIGNALS,...e].map(ar)};z.getSignals=or;var ar=function({name:e,number:t,description:r,action:n,forced:s=!1,standard:i}){let{signals:{[e]:o}}=rr.constants,a=o!==void 0;return{name:e,number:a?o:t,description:r,supported:a,action:n,forced:s,standard:i}}});var Nt=l(D=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0});D.signalsByNumber=D.signalsByName=void 0;var cr=require("os"),At=Gt(),ur=he(),lr=function(){return(0,At.getSignals)().reduce(dr,{})},dr=function(e,{name:t,number:r,description:n,supported:s,action:i,forced:o,standard:a}){return{...e,[t]:{name:t,number:r,description:n,supported:s,action:i,forced:o,standard:a}}},pr=lr();D.signalsByName=pr;var fr=function(){let e=(0,At.getSignals)(),t=ur.SIGRTMAX+1,r=Array.from({length:t},(n,s)=>mr(s,e));return Object.assign({},...r)},mr=function(e,t){let r=hr(e,t);if(r===void 0)return{};let{name:n,description:s,supported:i,action:o,forced:a,standard:u}=r;return{[e]:{name:n,number:e,description:s,supported:i,action:o,forced:a,standard:u}}},hr=function(e,t){let r=t.find(({name:n})=>cr.constants.signals[n]===e);return r!==void 0?r:t.find(n=>n.number===e)},gr=fr();D.signalsByNumber=gr});var Ot=l((Vs,Rt)=>{"use strict";var{signalsByName:Sr}=Nt(),yr=({timedOut:e,timeout:t,errorCode:r,signal:n,signalDescription:s,exitCode:i,isCanceled:o})=>e?`timed out after ${t} milliseconds`:o?"was canceled":r!==void 0?`failed with ${r}`:n!==void 0?`was killed with ${n} (${s})`:i!==void 0?`failed with exit code ${i}`:"failed",xr=({stdout:e,stderr:t,all:r,error:n,signal:s,exitCode:i,command:o,escapedCommand:a,timedOut:u,isCanceled:c,killed:p,parsed:{options:{timeout:h}}})=>{i=i===null?void 0:i,s=s===null?void 0:s;let m=s===void 0?void 0:Sr[s].description,y=n&&n.code,w=`Command ${yr({timedOut:u,timeout:h,errorCode:y,signal:s,signalDescription:m,exitCode:i,isCanceled:c})}: ${o}`,E=Object.prototype.toString.call(n)==="[object Error]",W=E?`${w}
${n.message}`:w,j=[W,t,e].filter(Boolean).join(`
`);return E?(n.originalMessage=n.message,n.message=j):n=new Error(j),n.shortMessage=W,n.command=o,n.escapedCommand=a,n.exitCode=i,n.signal=s,n.signalDescription=m,n.stdout=e,n.stderr=t,r!==void 0&&(n.all=r),"bufferedData"in n&&delete n.bufferedData,n.failed=!0,n.timedOut=Boolean(u),n.isCanceled=c,n.killed=p&&!u,n};Rt.exports=xr});var kt=l((Ks,ge)=>{"use strict";var J=["stdin","stdout","stderr"],wr=e=>J.some(t=>e[t]!==void 0),Bt=e=>{if(!e)return;let{stdio:t}=e;if(t===void 0)return J.map(n=>e[n]);if(wr(e))throw new Error(`It's not possible to provide \`stdio\` in combination with one of ${J.map(n=>`\`${n}\``).join(", ")}`);if(typeof t=="string")return t;if(!Array.isArray(t))throw new TypeError(`Expected \`stdio\` to be of type \`string\` or \`Array\`, got \`${typeof t}\``);let r=Math.max(t.length,J.length);return Array.from({length:r},(n,s)=>t[s])};ge.exports=Bt;ge.exports.node=e=>{let t=Bt(e);return t==="ipc"?"ipc":t===void 0||typeof t=="string"?[t,t,t,"ipc"]:t.includes("ipc")?t:[...t,"ipc"]}});var qt=l((zs,Z)=>{Z.exports=["SIGABRT","SIGALRM","SIGHUP","SIGINT","SIGTERM"];process.platform!=="win32"&&Z.exports.push("SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT");process.platform==="linux"&&Z.exports.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT","SIGUNUSED")});var jt=l((Js,A)=>{var d=global.process,I=function(e){return e&&typeof e=="object"&&typeof e.removeListener=="function"&&typeof e.emit=="function"&&typeof e.reallyExit=="function"&&typeof e.listeners=="function"&&typeof e.kill=="function"&&typeof e.pid=="number"&&typeof e.on=="function"};I(d)?(Lt=require("assert"),$=qt(),Mt=/^win/i.test(d.platform),k=require("events"),typeof k!="function"&&(k=k.EventEmitter),d.__signal_exit_emitter__?f=d.__signal_exit_emitter__:(f=d.__signal_exit_emitter__=new k,f.count=0,f.emitted={}),f.infinite||(f.setMaxListeners(1/0),f.infinite=!0),A.exports=function(e,t){if(!I(global.process))return function(){};Lt.equal(typeof e,"function","a callback must be provided for exit handler"),G===!1&&Se();var r="exit";t&&t.alwaysLast&&(r="afterexit");var n=function(){f.removeListener(r,e),f.listeners("exit").length===0&&f.listeners("afterexit").length===0&&Y()};return f.on(r,e),n},Y=function(){!G||!I(global.process)||(G=!1,$.forEach(function(t){try{d.removeListener(t,Q[t])}catch{}}),d.emit=ee,d.reallyExit=ye,f.count-=1)},A.exports.unload=Y,b=function(t,r,n){f.emitted[t]||(f.emitted[t]=!0,f.emit(t,r,n))},Q={},$.forEach(function(e){Q[e]=function(){if(!!I(global.process)){var r=d.listeners(e);r.length===f.count&&(Y(),b("exit",null,e),b("afterexit",null,e),Mt&&e==="SIGHUP"&&(e="SIGINT"),d.kill(d.pid,e))}}}),A.exports.signals=function(){return $},G=!1,Se=function(){G||!I(global.process)||(G=!0,f.count+=1,$=$.filter(function(t){try{return d.on(t,Q[t]),!0}catch{return!1}}),d.emit=Wt,d.reallyExit=_t)},A.exports.load=Se,ye=d.reallyExit,_t=function(t){!I(global.process)||(d.exitCode=t||0,b("exit",d.exitCode,null),b("afterexit",d.exitCode,null),ye.call(d,d.exitCode))},ee=d.emit,Wt=function(t,r){if(t==="exit"&&I(global.process)){r!==void 0&&(d.exitCode=r);var n=ee.apply(this,arguments);return b("exit",d.exitCode,null),b("afterexit",d.exitCode,null),n}else return ee.apply(this,arguments)}):A.exports=function(){return function(){}};var Lt,$,Mt,k,f,Y,b,Q,G,Se,ye,_t,ee,Wt});var Ht=l((Zs,Ut)=>{"use strict";var Pr=require("os"),Ir=jt(),br=1e3*5,vr=(e,t="SIGTERM",r={})=>{let n=e(t);return Er(e,t,r,n),n},Er=(e,t,r,n)=>{if(!Tr(t,r,n))return;let s=Cr(r),i=setTimeout(()=>{e("SIGKILL")},s);i.unref&&i.unref()},Tr=(e,{forceKillAfterTimeout:t},r)=>Fr(e)&&t!==!1&&r,Fr=e=>e===Pr.constants.signals.SIGTERM||typeof e=="string"&&e.toUpperCase()==="SIGTERM",Cr=({forceKillAfterTimeout:e=!0})=>{if(e===!0)return br;if(!Number.isFinite(e)||e<0)throw new TypeError(`Expected the \`forceKillAfterTimeout\` option to be a non-negative integer, got \`${e}\` (${typeof e})`);return e},Dr=(e,t)=>{e.kill()&&(t.isCanceled=!0)},$r=(e,t,r)=>{e.kill(t),r(Object.assign(new Error("Timed out"),{timedOut:!0,signal:t}))},Gr=(e,{timeout:t,killSignal:r="SIGTERM"},n)=>{if(t===0||t===void 0)return n;let s,i=new Promise((a,u)=>{s=setTimeout(()=>{$r(e,r,u)},t)}),o=n.finally(()=>{clearTimeout(s)});return Promise.race([i,o])},Ar=({timeout:e})=>{if(e!==void 0&&(!Number.isFinite(e)||e<0))throw new TypeError(`Expected the \`timeout\` option to be a non-negative integer, got \`${e}\` (${typeof e})`)},Nr=async(e,{cleanup:t,detached:r},n)=>{if(!t||r)return n;let s=Ir(()=>{e.kill()});return n.finally(()=>{s()})};Ut.exports={spawnedKill:vr,spawnedCancel:Dr,setupTimeout:Gr,validateTimeout:Ar,setExitHandler:Nr}});var Vt=l((Ys,Xt)=>{"use strict";var P=e=>e!==null&&typeof e=="object"&&typeof e.pipe=="function";P.writable=e=>P(e)&&e.writable!==!1&&typeof e._write=="function"&&typeof e._writableState=="object";P.readable=e=>P(e)&&e.readable!==!1&&typeof e._read=="function"&&typeof e._readableState=="object";P.duplex=e=>P.writable(e)&&P.readable(e);P.transform=e=>P.duplex(e)&&typeof e._transform=="function";Xt.exports=P});var zt=l((Qs,Kt)=>{"use strict";var{PassThrough:Rr}=require("stream");Kt.exports=e=>{e={...e};let{array:t}=e,{encoding:r}=e,n=r==="buffer",s=!1;t?s=!(r||n):r=r||"utf8",n&&(r=null);let i=new Rr({objectMode:s});r&&i.setEncoding(r);let o=0,a=[];return i.on("data",u=>{a.push(u),s?o=a.length:o+=u.length}),i.getBufferedValue=()=>t?a:n?Buffer.concat(a,o):a.join(""),i.getBufferedLength=()=>o,i}});var Jt=l((ei,q)=>{"use strict";var{constants:Or}=require("buffer"),Br=require("stream"),{promisify:kr}=require("util"),qr=zt(),Lr=kr(Br.pipeline),te=class extends Error{constructor(){super("maxBuffer exceeded"),this.name="MaxBufferError"}};async function xe(e,t){if(!e)throw new Error("Expected a stream");t={maxBuffer:1/0,...t};let{maxBuffer:r}=t,n=qr(t);return await new Promise((s,i)=>{let o=a=>{a&&n.getBufferedLength()<=Or.MAX_LENGTH&&(a.bufferedData=n.getBufferedValue()),i(a)};(async()=>{try{await Lr(e,n),s()}catch(a){o(a)}})(),n.on("data",()=>{n.getBufferedLength()>r&&o(new te)})}),n.getBufferedValue()}q.exports=xe;q.exports.buffer=(e,t)=>xe(e,{...t,encoding:"buffer"});q.exports.array=(e,t)=>xe(e,{...t,array:!0});q.exports.MaxBufferError=te});var Yt=l((ti,Zt)=>{"use strict";var{PassThrough:Mr}=require("stream");Zt.exports=function(){var e=[],t=new Mr({objectMode:!0});return t.setMaxListeners(0),t.add=r,t.isEmpty=n,t.on("unpipe",s),Array.prototype.slice.call(arguments).forEach(r),t;function r(i){return Array.isArray(i)?(i.forEach(r),this):(e.push(i),i.once("end",s.bind(null,i)),i.once("error",t.emit.bind(t,"error")),i.pipe(t,{end:!1}),this)}function n(){return e.length==0}function s(i){e=e.filter(function(o){return o!==i}),!e.length&&t.readable&&t.end()}}});var nn=l((ni,tn)=>{"use strict";var en=Vt(),Qt=Jt(),_r=Yt(),Wr=(e,t)=>{t===void 0||e.stdin===void 0||(en(t)?t.pipe(e.stdin):e.stdin.end(t))},jr=(e,{all:t})=>{if(!t||!e.stdout&&!e.stderr)return;let r=_r();return e.stdout&&r.add(e.stdout),e.stderr&&r.add(e.stderr),r},we=async(e,t)=>{if(!!e){e.destroy();try{return await t}catch(r){return r.bufferedData}}},Pe=(e,{encoding:t,buffer:r,maxBuffer:n})=>{if(!(!e||!r))return t?Qt(e,{encoding:t,maxBuffer:n}):Qt.buffer(e,{maxBuffer:n})},Ur=async({stdout:e,stderr:t,all:r},{encoding:n,buffer:s,maxBuffer:i},o)=>{let a=Pe(e,{encoding:n,buffer:s,maxBuffer:i}),u=Pe(t,{encoding:n,buffer:s,maxBuffer:i}),c=Pe(r,{encoding:n,buffer:s,maxBuffer:i*2});try{return await Promise.all([o,a,u,c])}catch(p){return Promise.all([{error:p,signal:p.signal,timedOut:p.timedOut},we(e,a),we(t,u),we(r,c)])}},Hr=({input:e})=>{if(en(e))throw new TypeError("The `input` option cannot be a stream in sync mode")};tn.exports={handleInput:Wr,makeAllStream:jr,getSpawnedResult:Ur,validateInputSync:Hr}});var sn=l((ri,rn)=>{"use strict";var Xr=(async()=>{})().constructor.prototype,Vr=["then","catch","finally"].map(e=>[e,Reflect.getOwnPropertyDescriptor(Xr,e)]),Kr=(e,t)=>{for(let[r,n]of Vr){let s=typeof t=="function"?(...i)=>Reflect.apply(n.value,t(),i):n.value.bind(t);Reflect.defineProperty(e,r,{...n,value:s})}return e},zr=e=>new Promise((t,r)=>{e.on("exit",(n,s)=>{t({exitCode:n,signal:s})}),e.on("error",n=>{r(n)}),e.stdin&&e.stdin.on("error",n=>{r(n)})});rn.exports={mergePromise:Kr,getSpawnedPromise:zr}});var cn=l((si,an)=>{"use strict";var on=(e,t=[])=>Array.isArray(t)?[e,...t]:[e],Jr=/^[\w.-]+$/,Zr=/"/g,Yr=e=>typeof e!="string"||Jr.test(e)?e:`"${e.replace(Zr,'\\"')}"`,Qr=(e,t)=>on(e,t).join(" "),es=(e,t)=>on(e,t).map(r=>Yr(r)).join(" "),ts=/ +/g,ns=e=>{let t=[];for(let r of e.trim().split(ts)){let n=t[t.length-1];n&&n.endsWith("\\")?t[t.length-1]=`${n.slice(0,-1)} ${r}`:t.push(r)}return t};an.exports={joinCommand:Qr,getEscapedCommand:es,parseCommand:ns}});var hn=l((ii,N)=>{"use strict";var rs=require("path"),Ie=require("child_process"),ss=yt(),is=wt(),os=bt(),as=Ft(),ne=Ot(),ln=kt(),{spawnedKill:cs,spawnedCancel:us,setupTimeout:ls,validateTimeout:ds,setExitHandler:ps}=Ht(),{handleInput:fs,getSpawnedResult:ms,makeAllStream:hs,validateInputSync:gs}=nn(),{mergePromise:un,getSpawnedPromise:Ss}=sn(),{joinCommand:dn,parseCommand:pn,getEscapedCommand:fn}=cn(),ys=1e3*1e3*100,xs=({env:e,extendEnv:t,preferLocal:r,localDir:n,execPath:s})=>{let i=t?{...process.env,...e}:e;return r?os.env({env:i,cwd:n,execPath:s}):i},mn=(e,t,r={})=>{let n=ss._parse(e,t,r);return e=n.command,t=n.args,r=n.options,r={maxBuffer:ys,buffer:!0,stripFinalNewline:!0,extendEnv:!0,preferLocal:!1,localDir:r.cwd||process.cwd(),execPath:process.execPath,encoding:"utf8",reject:!0,cleanup:!0,all:!1,windowsHide:!0,...r},r.env=xs(r),r.stdio=ln(r),process.platform==="win32"&&rs.basename(e,".exe")==="cmd"&&t.unshift("/q"),{file:e,args:t,options:r,parsed:n}},L=(e,t,r)=>typeof t!="string"&&!Buffer.isBuffer(t)?r===void 0?void 0:"":e.stripFinalNewline?is(t):t,re=(e,t,r)=>{let n=mn(e,t,r),s=dn(e,t),i=fn(e,t);ds(n.options);let o;try{o=Ie.spawn(n.file,n.args,n.options)}catch(y){let x=new Ie.ChildProcess,w=Promise.reject(ne({error:y,stdout:"",stderr:"",all:"",command:s,escapedCommand:i,parsed:n,timedOut:!1,isCanceled:!1,killed:!1}));return un(x,w)}let a=Ss(o),u=ls(o,n.options,a),c=ps(o,n.options,u),p={isCanceled:!1};o.kill=cs.bind(null,o.kill.bind(o)),o.cancel=us.bind(null,o,p);let m=as(async()=>{let[{error:y,exitCode:x,signal:w,timedOut:E},W,j,xn]=await ms(o,n.options,c),Te=L(n.options,W),Fe=L(n.options,j),Ce=L(n.options,xn);if(y||x!==0||w!==null){let De=ne({error:y,exitCode:x,signal:w,stdout:Te,stderr:Fe,all:Ce,command:s,escapedCommand:i,parsed:n,timedOut:E,isCanceled:p.isCanceled,killed:o.killed});if(!n.options.reject)return De;throw De}return{command:s,escapedCommand:i,exitCode:0,stdout:Te,stderr:Fe,all:Ce,failed:!1,timedOut:!1,isCanceled:!1,killed:!1}});return fs(o,n.options.input),o.all=hs(o,n.options),un(o,m)};N.exports=re;N.exports.sync=(e,t,r)=>{let n=mn(e,t,r),s=dn(e,t),i=fn(e,t);gs(n.options);let o;try{o=Ie.spawnSync(n.file,n.args,n.options)}catch(c){throw ne({error:c,stdout:"",stderr:"",all:"",command:s,escapedCommand:i,parsed:n,timedOut:!1,isCanceled:!1,killed:!1})}let a=L(n.options,o.stdout,o.error),u=L(n.options,o.stderr,o.error);if(o.error||o.status!==0||o.signal!==null){let c=ne({stdout:a,stderr:u,error:o.error,signal:o.signal,exitCode:o.status,command:s,escapedCommand:i,parsed:n,timedOut:o.error&&o.error.code==="ETIMEDOUT",isCanceled:!1,killed:o.signal!==null});if(!n.options.reject)return c;throw c}return{command:s,escapedCommand:i,exitCode:0,stdout:a,stderr:u,failed:!1,timedOut:!1,isCanceled:!1,killed:!1}};N.exports.command=(e,t)=>{let[r,...n]=pn(e);return re(r,n,t)};N.exports.commandSync=(e,t)=>{let[r,...n]=pn(e);return re.sync(r,n,t)};N.exports.node=(e,t,r={})=>{t&&!Array.isArray(t)&&typeof t=="object"&&(r=t,t=[]);let n=ln.node(r),s=process.execArgv.filter(a=>!a.startsWith("--inspect")),{nodePath:i=process.execPath,nodeOptions:o=s}=r;return re(i,[...o,e,...Array.isArray(t)?t:[]],{...r,stdin:void 0,stdout:void 0,stderr:void 0,stdio:n,shell:!1})}});var bs={};En(bs,{default:()=>yn});module.exports=Tn(bs);var g=require("@raycast/api"),v=require("child_process");var S=require("@raycast/api"),R=require("child_process");var be=Ge(require("node:process"),1),ve=Ge(hn(),1);async function Ee(e,{humanReadableOutput:t=!0}={}){if(be.default.platform!=="darwin")throw new Error("macOS only");let r=t?[]:["-ss"],{stdout:n}=await(0,ve.default)("osascript",["-e",e,r]);return n}function gn(e,{humanReadableOutput:t=!0}={}){if(be.default.platform!=="darwin")throw new Error("macOS only");let r=t?[]:["-ss"],{stdout:n}=ve.default.sync("osascript",["-e",e,...r]);return n}var ws=async()=>Ee(`set imageTypes to {"PNG", "JPG", "JPEG", "TIF", "HEIF", "GIF", "ICO", "ICNS", "ASTC", "BMP", "DDS", "EXR", "JP2", "KTX", "Portable Bitmap", "Adobe Photoshop", "PVR", "TGA", "WebP", "SVG", "PDF", "HEIC"}

    tell application "Finder"
      set theSelection to selection
      if theSelection is {} then
        return
      else if (theSelection count) is equal to 1 then
        repeat with imageType in imageTypes
          if (kind of the first item of theSelection) contains imageType then
            return the POSIX path of (theSelection as alias)
            exit repeat
          end if
        end repeat
      else
        set thePaths to {}
        repeat with i from 1 to (theSelection count)
          repeat with imageType in imageTypes
            if (kind of (item i of theSelection)) contains imageType then
              copy (POSIX path of (item i of theSelection as alias)) to end of thePaths
              exit repeat
            end if
          end repeat
        end repeat
        return thePaths
      end if
    end tell`),Ps=async()=>Ee(`set imageTypes to {"PNG", "JPG", "JPEG", "TIF", "HEIF", "GIF", "ICO", "ICNS", "ASTC", "BMP", "DDS", "EXR", "JP2", "KTX", "Portable Bitmap", "Adobe Photoshop", "PVR", "TGA", "WebP", "SVG", "PDF", "HEIC"}

    tell application "Path Finder"
      set theSelection to selection
      if theSelection is {} then
        return
      else if (theSelection count) is equal to 1 then
        repeat with imageType in imageTypes
          if (kind of the first item of theSelection) contains imageType then
            return the POSIX path of first item of theSelection
            exit repeat
          end if
        end repeat
      else
        set thePaths to {}
        repeat with i from 1 to (theSelection count)
          repeat with imageType in imageTypes
            if (kind of (item i of theSelection)) contains imageType then
              copy (POSIX path of (item i of theSelection)) to end of thePaths
              exit repeat
            end if
          end repeat
        end repeat
        return thePaths
      end if
    end tell`),Sn=async()=>{let e=[],r=(0,S.getPreferenceValues)().preferredFileManager,n=!1,s=r;try{s=(await(0,S.getFrontmostApplication)()).name}catch{console.log("Couldn't get frontmost application")}try{s=="Path Finder"&&r=="Path Finder"&&(await Ps()).split(", ").forEach(a=>{e.includes(a)||e.push(a)})}catch{console.log("Couldn't get images from Path Finder"),n=!0}let i=(await ws()).split(", ");return s=="Finder"||r=="Finder"||n?e.push(...i):i.forEach(o=>{o.split("/").at(-2)=="Desktop"&&!e.includes(o)&&e.push(o)}),e},M=async(e,t)=>{let r=`${S.environment.supportPath}/tmp.png`;(0,R.execSync)(`chmod +x ${S.environment.assetsPath}/webp/dwebp`),(0,R.execSync)(`chmod +x ${S.environment.assetsPath}/webp/cwebp`),(0,R.execSync)(`${S.environment.assetsPath}/webp/dwebp "${t}" -o "${r}" && ${e} "${r}" && ${S.environment.assetsPath}/webp/cwebp "${r}" -o "${t}" ; rm "${r}"`)},_=async(e,t)=>{let r=`${S.environment.supportPath}/tmp.bmp`;Is("BMP",t,r),(0,R.execSync)(`chmod +x ${S.environment.assetsPath}/potrace/potrace`),(0,R.execSync)(`${e} "${r}" && ${S.environment.assetsPath}/potrace/potrace -s --tight -o "${t}" "${r}"; rm "${r}"`)},Is=(e,t,r)=>{gn(`use framework "Foundation"

  -- Load SVG image from file
  set svgFilePath to "${t}"
  set svgData to current application's NSData's alloc()'s initWithContentsOfFile:svgFilePath
  
  -- Create image from SVG data
  set svgImage to current application's NSImage's alloc()'s initWithData:svgData
  
  -- Convert image to PNG data
  set tiffData to svgImage's TIFFRepresentation()
  set theBitmap to current application's NSBitmapImageRep's alloc()'s initWithData:tiffData
  set pngData to theBitmap's representationUsingType:(current application's NSBitmapImageFileType${e}) |properties|:(missing value)
  
  -- Save PNG data to file
  set pngFilePath to "${r}"
  pngData's writeToFile:pngFilePath atomically:true`)};async function yn(e){let{width:t,height:r}=e.arguments;if(t==""&&r==""){await(0,g.showToast)({title:"Must specify either width or height",style:g.Toast.Style.Failure});return}let n=t==""?-1:parseInt(t),s=r==""?-1:parseInt(r);if(isNaN(n)){await(0,g.showToast)({title:"Width must be an integer",style:g.Toast.Style.Failure});return}else if(isNaN(s)){await(0,g.showToast)({title:"Height must be an integer",style:g.Toast.Style.Failure});return}let i=await Sn();if(i.length===0||i.length===1&&i[0]===""){await(0,g.showToast)({title:"No images selected",style:g.Toast.Style.Failure});return}let o=await(0,g.showToast)({title:"Resizing in progress...",style:g.Toast.Style.Animated});if(i){let a=`image${i.length===1?"":"s"}`;try{let u='"'+i.join('" "')+'"';u.toLocaleLowerCase().includes("webp")||u.toLocaleLowerCase().includes("svg")?i.forEach(c=>{c.toLowerCase().endsWith(".webp")&&(M("sips --rotate ${degrees}",c),n!=-1&&s==-1?M(`sips --resampleWidth ${n}`,c):n==-1&&s!=-1?M(`sips --resampleHeight ${s}`,c):M(`sips --resampleHeightWidth ${s} ${n}`,c)),c.toLowerCase().endsWith(".svg")?(_("sips --rotate ${degrees}",c),n!=-1&&s==-1?_(`sips --resampleWidth ${n}`,c):n==-1&&s!=-1?_(`sips --resampleHeight ${s}`,c):_(`sips --resampleHeightWidth ${s} ${n}`,c)):n!=-1&&s==-1?(0,v.execSync)(`sips --resampleWidth ${n} "${c}"`):n==-1&&s!=-1?(0,v.execSync)(`sips --resampleHeight ${s} "${c}"`):(0,v.execSync)(`sips --resampleHeightWidth ${s} ${n} "${c}"`)}):n!=-1&&s==-1?(0,v.execSync)(`sips --resampleWidth ${n} ${u}`):n==-1&&s!=-1?(0,v.execSync)(`sips --resampleHeight ${s} ${u}`):(0,v.execSync)(`sips --resampleHeightWidth ${s} ${n} ${u}`),o.title=`Resized ${i.length.toString()} ${a}`,o.style=g.Toast.Style.Success}catch(u){console.log(u),o.title=`Failed to resize ${i.length.toString()} ${a}`,o.style=g.Toast.Style.Failure}}}0&&(module.exports={});
